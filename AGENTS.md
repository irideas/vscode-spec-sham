# AI Agent 协作规范

## 沟通语言
- 所有文档、提交信息、评审讨论及与 AI Agent 的交互统一使用简体中文。
- 引用外文规范或资料时，请同时给出中文释义，避免理解偏差。

## 基本协作流程
- 开始实现前先明确需求、约束与产出路径，必要时用简要计划对齐。
- 每次运行命令或修改文件后，在回复中说明目的与结果；涉及风险操作需提前声明。
- 版本号遵循 SemVer，并与 `CHANGELOG.md` 顶部段落保持一致；日期统一使用北京时间（UTC+8，格式 YYYY-MM-DD）。新增功能或修复在 `CHANGELOG.md` 顶部段落说明背景与验证。
- 文档仓最低检查：默认执行 `npm run docs:build`；若受环境限制无法执行需说明原因；若仓库增配 lint/format，再按配置执行。
- 禁止覆盖用户已有的未提交变更，除非得到明确指示。

## 提交与分支规范
- 提交信息遵循 Conventional Commits，主题使用中文并包含上下文前缀（如 `feat(tree-view): ...` / `docs(site): ...`），正文使用 `- ` 列表；命令行建议多个 `-m`，避免写字面量 `\n`。
- 每次提交需确保 `npm run docs:build`、`npm run lint`（若配置）或 `npm run test` 在本地通过；若因环境限制无法执行，需在提交描述中记录障碍。
- 新开分支命名为 `feature/spec-*`、`docs/spec-*` 或 `fix/spec-*` 等可读格式，避免使用个人名称；推送前确认分支与 PR 描述同步。
- 废弃或覆盖既有规范内容时，先在 `agents/session-summary.md` 记录原因，再提交代码。

## 提交/推送约束与自检
- 默认禁止自行执行 `git add/commit/push`，除非用户或维护者在对话中明确下达“可以提交/推送”等指令；如需展示进度，请用 `git status` / `git diff` 说明。
- 变更预览优先通过回复中的差异摘要或命令输出呈现，等待确认后再提交。
- 提交前自检（本仓通用）：  
  1) `npm run docs:build` 通过；  
  2) 本次变更涉及的站内链接可点击无误（尤其是跨域/跨目录引用）或已说明无法验证的原因；  
  3) 若调整版本号，`CHANGELOG.md` 与 `package.json` 保持一致；  
  4) `git status` 确认无无关改动；  
  5) 无法执行上述检查时需在回复中说明障碍与风险。

## 文档写作与链接规则
- SRS 只写可验证的事实与约束；设计/推荐/反模式放在 SDD 或章节内“建议/演进”小节。
- Index 页（各域总览）统一结构：引言/基线、角色与阅读路径、架构/生命周期摘要、文档矩阵、用例导航、质量与实践基线、使用方式。新域应对齐此格式。
- 交叉引用优先使用绝对路径（如 `/external-entry/uri-and-links-srs`），避免 `../` 相对路径；锚点使用同样策略。
- Tree View 域为深链/外部入口用例的主归宿，平台域（external-entry）引用 Tree 用例而不重复展开消费侧细节；平台域侧重“供给”概念、协议、安全模型与流程。
- 用例编号保持唯一，可在平台域做映射但不重复定义实质内容。
- 文档矩阵格式对齐 Tree View 生态：使用“域 | SRS | SDD | 摘要”四列表头，平台域与 Tree 域保持一致。

## 智能体工作区
- 仓库根目录下的 `agents/` 为智能体记录区，包含 `session-summary.md` 等协作产物；必要时记录阶段性结论、风险、待办或规范覆盖点。
- 若本仓库及子目录存在多个 `AGENTS.md`，以离目标文件最近的版本为准；若需覆盖其中规则，必须在 `agents/session-summary.md` 记录原因。
- 显式的人类指令优先生效；如与本规范冲突，请完成指令并在 `agents/session-summary.md` 备注差异。
- 程序化检查（如本规范或脚本要求的 `npm test`、`npm run build`）在涉及代码或文档变更时需确保可执行且通过，无法执行时说明障碍。

## 变更记录
- 2025-12-05：重写规范，精简通用约束并将智能体记录目录调整为 `agents/`。
- 2025-12-08：补充禁止自动提交/推送的约束，新增提交前自检清单、链接校验要求与文档写作/交叉引用规则。
