import{_ as a,c as l,o as i,ae as t}from"./chunks/framework.B_lm770W.js";const _=JSON.parse('{"title":"远程/浏览器路由 SDD（平台供给域）","description":"","frontmatter":{},"headers":[],"relativePath":"external-entry/remote-routing-sdd.md","filePath":"external-entry/remote-routing-sdd.md","lastUpdated":1765349849000}'),r={name:"external-entry/remote-routing-sdd.md"};function o(d,e,n,c,s,h){return i(),l("div",null,[...e[0]||(e[0]=[t('<h1 id="远程-浏览器路由-sdd-平台供给域" tabindex="-1">远程/浏览器路由 SDD（平台供给域） <a class="header-anchor" href="#远程-浏览器路由-sdd-平台供给域" aria-label="Permalink to &quot;远程/浏览器路由 SDD（平台供给域）&quot;">​</a></h1><p>提供 Remote/SSH/WSL/Tunnel/Codespaces/Web 场景下生成与消费外部入口的设计建议：重写策略、可达性检测、回退、实例路由等。消费方在各域实现具体 UI/业务。</p><h2 id="_1-设计目标" tabindex="-1">1. 设计目标 <a class="header-anchor" href="#_1-设计目标" aria-label="Permalink to &quot;1. 设计目标&quot;">​</a></h2><ul><li>可达性：生成的链接在目标环境可被实际点击/回调。</li><li>适配性：自动适配不同 scheme/authority/端口变化。</li><li>弹性：隧道变更或失效时有回退与提示。</li></ul><h2 id="_2-重写与生成策略" tabindex="-1">2. 重写与生成策略 <a class="header-anchor" href="#_2-重写与生成策略" aria-label="Permalink to &quot;2. 重写与生成策略&quot;">​</a></h2><ul><li>链接生成流程：内部 URI → <code>asExternalUri</code> 重写 →（可选）签名/ttl/nonce → 分发；分发时使用重写后的完整 URL。</li><li>不缓存硬编码 authority/端口；如需缓存，附带有效期并在使用前重新验证。</li><li>对外展示的 scheme 一律用 <code>vscode.env.uriScheme</code>，避免 Desktop/Web 差异。</li></ul><h2 id="_3-可达性与回退" tabindex="-1">3. 可达性与回退 <a class="header-anchor" href="#_3-可达性与回退" aria-label="Permalink to &quot;3. 可达性与回退&quot;">​</a></h2><ul><li>可选健康检查：在生成/消费前以 HEAD/GET 检查重写后的 URL 是否可达（若环境允许）；不可达则提示“需开启隧道/权限”。</li><li>回退策略： <ul><li>Remote 无法重写时，提示用户改用本地打开或手动复制内部地址；</li><li>Codespaces/隧道失效时，提示重新建立隧道或刷新页面。</li></ul></li><li>避免在 Handler 内长时间等待网络；超时应提示并允许用户重试。</li></ul><h2 id="_4-实例与窗口路由" tabindex="-1">4. 实例与窗口路由 <a class="header-anchor" href="#_4-实例与窗口路由" aria-label="Permalink to &quot;4. 实例与窗口路由&quot;">​</a></h2><ul><li>默认仅当前客户端实例收到 <code>onUri</code>；如需多实例同步，需自行广播（存储/IPC/服务端下发）。</li><li>设计命令/Service 时避免依赖“唯一窗口”假设；如结果需要跨窗口显示，使用消息通道或存储。</li></ul><h2 id="_5-反模式" tabindex="-1">5. 反模式 <a class="header-anchor" href="#_5-反模式" aria-label="Permalink to &quot;5. 反模式&quot;">​</a></h2><ul><li>硬编码 <code>vscode://</code> 或固定端口，忽略 <code>asExternalUri</code>，导致 Remote/Web 不可用。</li><li>对重写结果长期缓存、不做有效性检查，导致链接失效。</li><li>在 Handler 中执行网络重试阻塞 UI；应异步并提示。</li></ul><h2 id="_6-检查清单" tabindex="-1">6. 检查清单 <a class="header-anchor" href="#_6-检查清单" aria-label="Permalink to &quot;6. 检查清单&quot;">​</a></h2><ul><li>[ ] 生成共享链接前调用 <code>asExternalUri</code>；分发使用重写后的 URL。</li><li>[ ] 使用 <code>uriScheme</code> 而非硬编码 scheme。</li><li>[ ] 对重写后的 URL 进行可达性提示/回退（至少提示无法重写/无隧道）。</li><li>[ ] 不假定多窗口路由；必要时自行广播或提示限制。</li><li>[ ] 高风险/敏感操作继续遵守安全 SRS（确认、脱敏、签名）。</li></ul><h2 id="_7-演进" tabindex="-1">7. 演进 <a class="header-anchor" href="#_7-演进" aria-label="Permalink to &quot;7. 演进&quot;">​</a></h2><ul><li>提供官方重写结果的有效期/稳定性提示接口。</li><li>提供多实例路由策略（选择窗口/实例）的平台支持。</li><li>SDK 级封装：生成、签名、重写、健康检查的一站式工具。</li></ul>',16)])])}const m=a(r,[["render",o]]);export{_ as __pageData,m as default};
