import{_ as i,c as a,o as n,ae as t}from"./chunks/framework.B_lm770W.js";const o=JSON.parse('{"title":"VS Code Configuration 声明子系统软件设计说明书 (SDD)","description":"","frontmatter":{},"headers":[],"relativePath":"configuration-system/configuration-declaration-sdd.md","filePath":"configuration-system/configuration-declaration-sdd.md","lastUpdated":1765349849000}'),h={name:"configuration-system/configuration-declaration-sdd.md"};function l(e,s,k,p,r,d){return n(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="vs-code-configuration-声明子系统软件设计说明书-sdd" tabindex="-1">VS Code Configuration 声明子系统软件设计说明书 (SDD) <a class="header-anchor" href="#vs-code-configuration-声明子系统软件设计说明书-sdd" aria-label="Permalink to &quot;VS Code Configuration 声明子系统软件设计说明书 (SDD)&quot;">​</a></h1><h2 id="_1-文档背景与设计目标" tabindex="-1">1. 文档背景与设计目标 <a class="header-anchor" href="#_1-文档背景与设计目标" aria-label="Permalink to &quot;1. 文档背景与设计目标&quot;">​</a></h2><h3 id="_1-1-背景与基线" tabindex="-1">1.1 背景与基线 <a class="header-anchor" href="#_1-1-背景与基线" aria-label="Permalink to &quot;1.1 背景与基线&quot;">​</a></h3><ul><li>基线：<code>engines.vscode</code> ≥ 1.80，兼容 Remote/Web/Profile/Policy 场景。</li><li>参考：VS Code Contribution Points（<code>contributes.configuration</code>、<code>configurationDefaults</code>）、Settings UI/Sync/Policy 文档；站内 /configuration-system/configuration-core-srs、/configuration-system/configuration-declaration-srs。</li></ul><h3 id="_1-2-设计目标" tabindex="-1">1.2 设计目标 <a class="header-anchor" href="#_1-2-设计目标" aria-label="Permalink to &quot;1.2 设计目标&quot;">​</a></h3><ul><li>提供统一、高效、可诊断的 Configuration Schema Registry，支撑核心与扩展的 schema 注册、查询与校验。</li><li>为 Settings UI、JSON 语言服务、Configuration Service、Sync/Policy 提供一致的元数据源。</li><li>在大规模扩展生态下保持性能、缓存与热加载/卸载能力。</li></ul><h3 id="_1-3-设计约束与原则" tabindex="-1">1.3 设计约束与原则 <a class="header-anchor" href="#_1-3-设计约束与原则" aria-label="Permalink to &quot;1.3 设计约束与原则&quot;">​</a></h3><ul><li>对外契约与 SRS 一致：校验规则、冲突处理、对外接口保持兼容。</li><li>Registry 只读暴露，写路径仅通过正规注册流程（核心/扩展/默认覆盖）。</li><li>热注册/卸载需可清理或标记扩展贡献的设置，避免残留。</li><li>可观测性：校验错误/冲突需有诊断可查；查询接口具备索引/缓存。</li></ul><hr><h2 id="_2-组件视图" tabindex="-1">2. 组件视图 <a class="header-anchor" href="#_2-组件视图" aria-label="Permalink to &quot;2. 组件视图&quot;">​</a></h2><h3 id="_2-1-组件视图" tabindex="-1">2.1 组件视图 <a class="header-anchor" href="#_2-1-组件视图" aria-label="Permalink to &quot;2.1 组件视图&quot;">​</a></h3><ol><li><strong>ConfigurationRegistry</strong>：存储/查询所有 Setting Schema，维护按 ID / 扩展 / 类别索引，向外暴露只读接口。</li><li><strong>CoreConfigurationContributor</strong>：启动时注入内置 Setting 声明，构建 default configuration。</li><li><strong>ExtensionConfigurationReader</strong>：读取扩展 <code>contributes.configuration</code> 与 <code>configurationDefaults</code>，生成内部 IR。</li><li><strong>SchemaNormalizer &amp; Validator</strong>：填充默认值，校验类型/enum/scope/ignoreSync，拒绝不支持的 JSON Schema 片段。</li><li><strong>ConfigurationDefaultsRegistry</strong>：存储 configurationDefaults 的 default override（含语言块）。</li><li><strong>RegistryQueryFacade</strong>：为 Settings UI / JSON 语言服务 / Configuration Service / Sync/Policy 提供受控查询接口。</li><li><strong>Diagnostics &amp; Telemetry</strong>：记录 schema 解析/校验的错误与警告，必要时上报常见错误模式。</li></ol><h3 id="_2-2-与其他子系统-外部系统的依赖关系" tabindex="-1">2.2 与其他子系统 / 外部系统的依赖关系 <a class="header-anchor" href="#_2-2-与其他子系统-外部系统的依赖关系" aria-label="Permalink to &quot;2.2 与其他子系统 / 外部系统的依赖关系&quot;">​</a></h3><ul><li><strong>存储与分层子系统</strong>：读取 Schema 和 default overrides 以构建 defaultSettings、校验写入。</li><li><strong>访问与变更子系统</strong>：基于 Schema 做 <code>inspect</code> / <code>update</code> 类型与 scope 检查。</li><li><strong>Settings UI 子系统</strong>：通过 Facade 获取 Category/Setting 列表与元数据。</li><li><strong>Settings Sync / Enterprise Policy（外部）</strong>：通过 Facade 获取 scope/ignoreSync/policyCapable 等元数据。</li></ul><hr><h2 id="_3-内部数据模型设计" tabindex="-1">3. 内部数据模型设计 <a class="header-anchor" href="#_3-内部数据模型设计" aria-label="Permalink to &quot;3. 内部数据模型设计&quot;">​</a></h2><h3 id="_3-1-中间表示-ir" tabindex="-1">3.1 中间表示（IR） <a class="header-anchor" href="#_3-1-中间表示-ir" aria-label="Permalink to &quot;3.1 中间表示（IR）&quot;">​</a></h3><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RawConfigurationContribution</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RawConfigurationObject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RawConfigurationObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RawConfigurationObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  title</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RawSettingSchema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RawSettingSchema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  markdownDescription</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  enum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  enumDescriptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  markdownEnumDescriptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  tags</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  ignoreSync</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  deprecationMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  markdownDeprecationMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  minimum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  maximum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  pattern</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  items</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  order</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  policyCapable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 预留</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_3-2-registry-结构-示意" tabindex="-1">3.2 Registry 结构（示意） <a class="header-anchor" href="#_3-2-registry-结构-示意" aria-label="Permalink to &quot;3.2 Registry 结构（示意）&quot;">​</a></h3><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SettingSchemaModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  extensionId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;vscode-core&#39; 或扩展 ID</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  categoryId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  markdownDescription</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  enum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  enumDescriptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  markdownEnumDescriptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;application&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;window&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;resource&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;machine&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;machine-overridable&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  deprecationMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  markdownDeprecationMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  tags</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  order</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  ignoreSync</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  policyCapable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ConfigurationCategoryModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// \`\${extensionId}:\${localName}\`</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  title</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  extensionId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SettingSchemaModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ConfigurationRegistry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> settings</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SettingSchemaModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> categories</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ConfigurationCategoryModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> extensionToSettings</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]&gt;();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 查询接口见第 5 章</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_3-3-configurationdefaults-registry" tabindex="-1">3.3 ConfigurationDefaults Registry <a class="header-anchor" href="#_3-3-configurationdefaults-registry" aria-label="Permalink to &quot;3.3 ConfigurationDefaults Registry&quot;">​</a></h3><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefaultOverride</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;files.autoSave&#39; 或 &#39;[markdown]&#39;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  extensionId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ConfigurationDefaultsRegistry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  overrides</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefaultOverride</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h2 id="_4-关键流程设计" tabindex="-1">4. 关键流程设计 <a class="header-anchor" href="#_4-关键流程设计" aria-label="Permalink to &quot;4. 关键流程设计&quot;">​</a></h2><h3 id="_4-1-启动时注册核心设置" tabindex="-1">4.1 启动时注册核心设置 <a class="header-anchor" href="#_4-1-启动时注册核心设置" aria-label="Permalink to &quot;4.1 启动时注册核心设置&quot;">​</a></h3><ol><li>CoreConfigurationContributor 构建内置 <code>SettingSchemaModel</code> 列表。</li><li>调用 <code>ConfigurationRegistry.registerCoreSettings(coreSchemas)</code>；SchemaValidator 校验 ID 唯一、类型与默认值合法。</li><li>写入 <code>settings</code>/<code>categories</code> 索引，生成 Default Configuration 视图供存储与分层子系统使用。</li></ol><h3 id="_4-2-安装-启用扩展时注册设置" tabindex="-1">4.2 安装 / 启用扩展时注册设置 <a class="header-anchor" href="#_4-2-安装-启用扩展时注册设置" aria-label="Permalink to &quot;4.2 安装 / 启用扩展时注册设置&quot;">​</a></h3><ol><li>Extension Host 解析扩展 <code>package.json</code>，Reader 读取 <code>contributes.configuration</code>（单对象或数组）。</li><li>生成 IR，Normalizer 填补类别默认 <code>type: &quot;object&quot;</code>、补 scope/ignoreSync 默认，校验 default/enum/type。</li><li>Validator 检测 ID 冲突、不支持的 JSON Schema 特性（如 <code>$ref</code>），非法片段记录诊断并跳过。</li><li>对合法 schema 调用 <code>ConfigurationRegistry.registerExtensionSettings(extensionId, categoryModels)</code>，更新索引与 <code>extensionToSettings</code>。</li><li>解析 <code>configurationDefaults</code>，生成 DefaultOverride 列表存入 ConfigurationDefaultsRegistry。</li></ol><h3 id="_4-3-卸载-禁用扩展时清理" tabindex="-1">4.3 卸载 / 禁用扩展时清理 <a class="header-anchor" href="#_4-3-卸载-禁用扩展时清理" aria-label="Permalink to &quot;4.3 卸载 / 禁用扩展时清理&quot;">​</a></h3><ol><li>根据 extensionId 获取相关 Setting ID。</li><li>从 <code>settings</code>/<code>categories</code> 移除或标记不可用的设置；空类别删除。</li><li>触发 <code>ConfigurationSchemaChangeEvent</code>，通知 Settings UI / Configuration Service 刷新。</li></ol><h3 id="_4-4-settings-ui-查询流程" tabindex="-1">4.4 Settings UI 查询流程 <a class="header-anchor" href="#_4-4-settings-ui-查询流程" aria-label="Permalink to &quot;4.4 Settings UI 查询流程&quot;">​</a></h3><ol><li>Settings UI 通过 Facade 获取 Category 列表与对应 Setting 列表。</li><li>按 Schema 渲染控件（boolean→checkbox、enum→dropdown、tags→提示等），结合 scope/Policy/Sync 状态调整可编辑性。</li></ol><h3 id="_4-5-settings-json-json-schema-暴露流程" tabindex="-1">4.5 settings.json JSON Schema 暴露流程 <a class="header-anchor" href="#_4-5-settings-json-json-schema-暴露流程" aria-label="Permalink to &quot;4.5 settings.json JSON Schema 暴露流程&quot;">​</a></h3><ol><li>JSON 语言服务请求 settings.json Schema。</li><li>声明子系统提供 Setting ID → Schema 映射，含枚举与 Markdown 描述。</li><li>JSON LS 生成补全、类型检查、错误诊断与 hover 提示。</li></ol><h3 id="_4-6-configurationdefaults-合并流程" tabindex="-1">4.6 configurationDefaults 合并流程 <a class="header-anchor" href="#_4-6-configurationdefaults-合并流程" aria-label="Permalink to &quot;4.6 configurationDefaults 合并流程&quot;">​</a></h3><ol><li>存储与分层子系统构建 defaultSettings 时读取 DefaultOverride： <ul><li>先加载核心默认值；</li><li>再按扩展顺序叠加 overrides（含语言块）。</li></ul></li><li>对不存在的 Setting ID 记录诊断并跳过，避免污染 defaultSettings。</li></ol><hr><h2 id="_5-对外接口设计-registryqueryfacade" tabindex="-1">5. 对外接口设计（RegistryQueryFacade） <a class="header-anchor" href="#_5-对外接口设计-registryqueryfacade" aria-label="Permalink to &quot;5. 对外接口设计（RegistryQueryFacade）&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IConfigurationRegistry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getSchema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">settingId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SettingSchemaModel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getAllSettings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Iterable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SettingSchemaModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getSettingsByExtension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">extensionId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Iterable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SettingSchemaModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getCategories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Iterable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ConfigurationCategoryModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getSettingsByCategory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">categoryId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Iterable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SettingSchemaModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  onDidChangeSchema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Event</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ConfigurationSchemaChangeEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ConfigurationSchemaChangeEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  added</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  removed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  updated</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  source</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;core&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;core&#39; 或扩展 ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>Settings UI / JSON LS / Configuration Service / Sync/Policy 仅通过该接口读取，不直接访问内部 Map。</li></ul><hr><h2 id="_6-校验与错误处理策略" tabindex="-1">6. 校验与错误处理策略 <a class="header-anchor" href="#_6-校验与错误处理策略" aria-label="Permalink to &quot;6. 校验与错误处理策略&quot;">​</a></h2><h3 id="_6-1-schemavalidator-规则-要点" tabindex="-1">6.1 SchemaValidator 规则（要点） <a class="header-anchor" href="#_6-1-schemavalidator-规则-要点" aria-label="Permalink to &quot;6.1 SchemaValidator 规则（要点）&quot;">​</a></h3><ul><li>Setting ID 需匹配 <code>/^[a-z0-9]+(\\\\.[a-z0-9]+)*$/i</code>。</li><li><code>default</code> 类型与 <code>type</code> 兼容；<code>enum</code> 与 <code>default</code> 同构；scope 为受支持枚举或注册扩展 scope。</li><li>不支持的 JSON Schema 特性（如 <code>$ref</code>）给出警告并跳过。</li></ul><h3 id="_6-2-错误处理" tabindex="-1">6.2 错误处理 <a class="header-anchor" href="#_6-2-错误处理" aria-label="Permalink to &quot;6.2 错误处理&quot;">​</a></h3><ul><li>扩展 schema 错误：记录诊断，不影响 VS Code 启动；在扩展诊断视图/开发者工具中提示。</li><li>核心 schema 错误：开发阶段阻断合入；运行时发现时记录高优日志，必要时回退到安全默认。</li><li>对冲突（同 ID 类型不兼容）按“先注册者优先”或明确策略取舍，并输出警告。</li></ul><hr><h2 id="_7-性能与缓存设计-简要" tabindex="-1">7. 性能与缓存设计（简要） <a class="header-anchor" href="#_7-性能与缓存设计-简要" aria-label="Permalink to &quot;7. 性能与缓存设计（简要）&quot;">​</a></h2><ul><li>查询路径使用多重索引（ID / extId / categoryId），保持 O(1)/O(log n)。</li><li>大规模扩展下支持延迟加载：冷启动仅加载核心 schema，首次访问扩展 schema 时解析并缓存。</li><li>configurationDefaults 采用按 languageId/settingId 的前缀索引，减少 merge 成本。</li><li>对 Settings UI 所需的全量快照可做只读缓存，Schema 变更事件触发增量更新。</li></ul><hr><h2 id="_8-安全性与可观测性" tabindex="-1">8. 安全性与可观测性 <a class="header-anchor" href="#_8-安全性与可观测性" aria-label="Permalink to &quot;8. 安全性与可观测性&quot;">​</a></h2><ul><li>禁止扩展在运行时绕过 Manifest 动态写入 Registry 内部结构。</li><li>Diagnostics &amp; Telemetry：统计常见错误（ID 冲突、类型不匹配、枚举错误等），可选上报用于生态治理。</li></ul><hr><h2 id="_9-扩展性与演进-含测试建议" tabindex="-1">9. 扩展性与演进（含测试建议） <a class="header-anchor" href="#_9-扩展性与演进-含测试建议" aria-label="Permalink to &quot;9. 扩展性与演进（含测试建议）&quot;">​</a></h2><ul><li>预留 policyCapable / ignoreSync 等额外标记，兼容未来策略/同步特性。</li><li>可增加增量 schema 变更广播，供 Settings UI / JSON LS 热刷新。</li><li>测试建议：覆盖核心/扩展 schema 注册、冲突检测、configurationDefaults 应用、热卸载清理、查询性能基准。</li></ul>`,55)])])}const E=i(h,[["render",l]]);export{o as __pageData,E as default};
